# DPS计算规则更新设计文档

## 1. 背景与目标

### 1.1 问题描述
当前游戏中武器的DPS（每秒伤害）计算方式仅基于基础伤害、射击间隔和子弹速度，没有考虑子弹的实际覆盖面积。这导致像WAVE这类宽幅子弹武器在图鉴中显示的DPS偏低，但实际上由于其宽幅覆盖能力，在面对密集敌人时表现非常强势。

### 1.2 目标
- 更新DPS计算公式，使其包含子弹宽度因素，更准确地反映武器实际战斗效能
- 在图鉴中显示所有武器、敌人和Boss的重要属性
- 确保新的DPS计算方法适用于所有类型的武器、敌人和Boss

## 2. 设计方案

### 2.1 新DPS计算公式
为了更准确地评估武器的实际战斗效能，特别是对于宽幅子弹武器，我们需要修改现有的DPS计算公式：

**原公式：**
```
DPS = (基础伤害 + 等级伤害加成) × (1000 / 射击间隔) × (子弹速度 / 基准速度)
```

**新公式：**
```
有效伤害 = (基础伤害 + 等级伤害加成) × (子弹宽度 / 基准宽度)
DPS = 有效伤害 × (1000 / 射击间隔) × (子弹速度 / 基准速度)
```

其中：
- 基准宽度设定为10像素（参考VULCAN子弹宽度）
- 子弹宽度从武器配置的bullet.size.width获取
- 对于穿透性武器（如LASER、WAVE），其实际效能会更高，因为一次攻击可以伤害多个目标

### 2.2 图鉴属性展示增强

#### 2.2.1 武器详情页面
需要在现有基础上增加以下信息：
- 子弹宽度（像素）
- 实际DPS计算值（使用新公式）
- 特殊属性标识（穿透、连锁、爆炸等）
- 子弹高度（像素）

#### 2.2.2 敌人详情页面
需要显示以下关键属性：
- 基础生命值和每级增长
- 移动速度和每级增长
- 子弹类型和伤害
- 攻击频率
- 击杀得分
- 子弹尺寸（宽度×高度）

#### 2.2.3 Boss详情页面
需要显示以下关键属性：
- 总生命值
- 移动模式
- 武器配置（类型、数量、速度）
- 攻击频率
- 阶段变化机制
- 击杀得分
- 子弹尺寸（宽度×高度）

## 3. 实现计划

### 3.1 修改DPS计算器
1. 更新`calculateDPS`函数以使用新公式
2. 添加基准宽度参数（默认为10）
3. 从武器配置中获取子弹宽度信息

### 3.2 更新图鉴显示组件
1. 修改`WeaponDetail.tsx`组件以显示子弹宽度和新DPS值
2. 修改`EnemyDetail.tsx`组件以显示更多战斗相关属性
3. 修改`BossDetail.tsx`组件以显示完整武器配置信息

### 3.3 数据模型调整
1. 确保所有武器配置都包含完整的子弹尺寸信息
2. 为敌人和Boss添加必要的属性展示字段

## 4. 影响分析

### 4.1 正面影响
- 玩家能够更准确地评估武器的实际战斗效能
- 图鉴信息更加全面，有助于玩家做出更好的装备选择
- 特殊武器（如WAVE）的价值得到正确体现

### 4.2 潜在风险
- DPS数值的整体调整可能影响游戏平衡性
- 需要重新评估所有武器的相对强度
- 可能需要调整部分武器的基础属性以维持平衡

## 5. 验证标准
1. 所有武器在图鉴中正确显示新的DPS值
2. 敌人和Boss详情页面显示完整的属性信息
3. 新的DPS计算公式符合设计预期
4. 游戏整体平衡性未受到负面影响
