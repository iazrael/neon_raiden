# 数值平衡设计

数值平衡 = **「先定尺子 → 再填表格 → 再跑仿真 → 再人工微调」**  
下面给出**「从零到可玩」**的完整流程 + **可抄 Excel 模板**，  
**全部数值都能热重载**，**不重启游戏**。

---

## 一、先定「尺子」——让玩家有「手感锚点」

| 锚点 | 建议值 | 理由 |
|------|--------|------|
| **玩家移动速度** | 400~500 px/s | 手指/摇杆跟手，≈ 8 格/秒 |
| **屏幕宽度** | 960 px | 手机横屏 16:9 |
| **敌人出生 Y** | -80 px | 从屏幕外滑入，给 0.5 s 预警 |
| **基础敌人血量** | **100 HP** | **所有伤害以 100 为基准倍数** |
| **基础敌人速度** | 120 px/s | 玩家 1/4，可轻松绕背 |
| **基础武器冷却** | **500 ms** | 手指点击极限 ≈ 10 发/秒** |

> **所有伤害、冷却、面积**都以「**基础武器 = 100 伤害/500 ms**」为**1 倍率**。

---

## 二、填表格——用「倍率 + 基准」填表

### ① 武器表（Spec）

| id | damage | cooldown(ms) | area(px) | pierce | bounces | speed(px/s) | description |
|----|--------|--------------|----------|--------|---------|-------------|-------------|
| laser | 100 | 500 | 4 | 0 | 0 | 800 | 基准 |
| plasma | 150 | 600 | 8 | 1 | 0 | 700 | 1.2 倍伤害，1 穿透 |
| shotgun | 80×5 | 700 | 6 | 0 | 0 | 600 | 5 弹片，面积 1.5 倍 |
| rail | 400 | 1200 | 2 | 99 | 0 | 1200 | 秒杀小敌，长冷却 |

**公式**：
- **DPS** = `damage / (cooldown/1000)`  
- **面积倍率** = `area / 4`（基准半径 4 px）  
- **总输出** = `DPS × 面积倍率 × (1 + pierce×0.5 + bounces×0.3)`

---

### ② 敌人表（HP 以 100 为基准）

| id | hp | speed(px/s) | reward | 描述 |
|----|----|-------------|--------|------|
| grunt | 100 | 120 | 10 | 1 倍 |
| elite | 200 | 140 | 25 | 2 倍，稍快 |
| tank | 500 | 80 | 50 | 5 倍，慢，大碰撞盒 |

---

### ③ 难度倍率表（随 `world.difficulty`）

| 难度等级 | hp倍 | speed倍 | 掉落倍 | 生成间隔倍 |
|----------|------|---------|--------|------------|
| 1 | 1.0 | 1.0 | 1.0 | 1.0 |
| 2 | 1.2 | 1.1 | 1.1 | 0.9 |
| 3 | 1.5 | 1.2 | 1.2 | 0.8 |

> **只改倍率，不改绝对值** → 一键全局平衡。

---

## 三、跑仿真——用「事件回放」验证

1. **每帧记录**：
   ```json
   { "t": 1.23, "events": [{"type":"Kill","id":"grunt","dmg":100},{"type":"Pickup","id":"coin"}] }
   ```
2. **跑 100 关模拟** → 输出：
   - **平均通关时间**  
   - **平均 DPS**  
   - **平均拾取数**  
   - **死亡帧分布**（是否突然陡升）

3. **Excel 透视表** → 自动标红「**异常关卡**」

---

## 四、人工微调——「手感旋钮」

| 旋钮 | 调整范围 | 手感影响 |
|------|----------|----------|
| **冷却 ±20 ms** | 明显「卡手/连发」 |  
| **面积 ±2 px** | 明显「命中率」 |  
| **速度 ±50 px/s** | 明显「命中/躲避」 |  

> **每次只调 1 个参数**，**跑 10 局**，**记录手感评分**（1-5 星）。

---

## 五、热重载工具（可选）

```typescript
// configs/hotReload.ts
if (import.meta.hot) {
  import.meta.hot.accept('/src/blueprints/weapons.ts', (mod) => {
    WEAPON_TABLE = mod.WEAPON_TABLE;
    console.log('🔥 武器表已热重载');
  });
}
```
**调数值 → 保存 → 游戏内立即生效**，**不重启**。

---

## 六、一句话背下来

**「先定手感锚点，用倍率填表，跑仿真验证，旋钮微调，**  
**全部数值放配置表，热重载即时生效，**  
**以『基础武器 = 100 伤害 / 500 ms』为 1 倍率，**  
**只调倍率不调绝对值，Excel 透视找异常，手感旋钮 1 参数 10 局。」**

